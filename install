#! /bin/sh

set -e

### TIDY THIS UP

FILES='emacs muttrc bashrc git-ignores indent.pro screenrc plan project
pgpkey profile bashrc nanorc zshenv zshrc zshprofile zshlogin zshlogout
tmux.conf iterm2_shell_integration.bash
profile.common
profile.init.sh profile.colours.sh profile.dircolors.sh profile.prompt.sh
profile.macosx.sh profile.banner.sh profile.paths.sh profile.fini.sh'

here=$(dirname "$0")
here=$(cd "$here" && pwd)

for f in $FILES ; do
	if test -h $HOME/.$f ; then
		echo "- Removing existing symbolic link at $HOME/.$f" >&2
		rm $HOME/.$f
	elif test -e $HOME/.$f ; then
		echo "- Moving existing $HOME/$f out of the way" >&2
		mv $HOME/.$f $HOME/.$f.dotfiles-backup-`date +%Y%m%d%H%M%S`
	fi
done

## Install shell initialisation scripts

ln -sf "$here/sh/profile" "$HOME/.profile"
ln -sf "$here/sh/bash/bashrc" "$HOME/.bashrc"
ln -sf "$here/sh/zsh/zshenv" "$HOME/.zshenv"
ln -sf "$here/sh/zsh/zprofile" "$HOME/.zprofile"
ln -sf "$here/sh/zsh/zshrc" "$HOME/.zshrc"
ln -sf "$here/sh/zsh/zlogin" "$HOME/.zlogin"
ln -sf "$here/sh/zsh/zlogout" "$HOME/.zlogout"
