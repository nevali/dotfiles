init_terminal
init_paths "$paths_mode"
init_dircolors
init_prompt
sysbanner "$banner_mode"

if test $is_interactive -eq 1 ; then
	if test x"$shell_name" = x"bash" ; then
		. "${PROFILEDIR}/../bash/iterm2_shell_integration.bash"
		if type -t iterm2_preexec_invoke_cmd 2>/dev/null >&2 ; then
			ITERM_PREEXEC_INTERACTIVE_MODE="yes"
			iterm2_preexec_invoke_cmd
		fi
	fi
	if test x"$shell_name" = x"zsh" ; then
		. "${PROFILEDIR}/../zsh/iterm2_shell_integration.zsh"
		if whence -v iterm2_preexec_invoke_cmd 2>/dev/null >&2 ; then
			ITERM_PREEXEC_INTERACTIVE_MODE="yes"
			iterm2_preexec_invoke_cmd
		fi
	fi
fi

if test $update_promptcmd -eq 1 ; then
	PROMPT_COMMAND="profile_precmd"

	precmd() {
		profile_precmd
	}

	if test x"$shell_name" = x"bash" ; then
		if type -t iterm2_preexec_invoke_cmd 2>/dev/null >&2 ; then
			PROMPT_COMMAND="profile_precmd ; iterm2_preexec_invoke_cmd"
		fi
	fi
fi
